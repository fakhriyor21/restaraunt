-- food_delivery.db

-- Categories table
CREATE TABLE categories (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name VARCHAR(100) NOT NULL,
    description TEXT,
    image_url VARCHAR(255),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Foods table
CREATE TABLE foods (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name VARCHAR(100) NOT NULL,
    description TEXT,
    price DECIMAL(10, 2) NOT NULL,
    category_id INTEGER NOT NULL,
    image_url VARCHAR(255),
    rating DECIMAL(3, 2) DEFAULT 0.00,
    is_popular BOOLEAN DEFAULT 0,
    is_available BOOLEAN DEFAULT 1,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (category_id) REFERENCES categories(id)
);

-- Users table
CREATE TABLE users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    phone VARCHAR(20),
    address TEXT,
    password_hash VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Orders table
CREATE TABLE orders (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    total_amount DECIMAL(10, 2) NOT NULL,
    delivery_address TEXT NOT NULL,
    status VARCHAR(20) DEFAULT 'pending',
    payment_method VARCHAR(20),
    payment_status VARCHAR(20) DEFAULT 'pending',
    order_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
);

-- Order items table
CREATE TABLE order_items (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    order_id INTEGER NOT NULL,
    food_id INTEGER NOT NULL,
    quantity INTEGER NOT NULL,
    price DECIMAL(10, 2) NOT NULL,
    FOREIGN KEY (order_id) REFERENCES orders(id),
    FOREIGN KEY (food_id) REFERENCES foods(id)
);

-- Insert sample data
INSERT INTO categories (name, description, image_url) VALUES 
('Milliy Taomlar', 'O''zbekistonning an''anaviy taomlari', 'https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'),
('Fast Food', 'Tez tayyorlanadigan taomlar', 'https://images.unsplash.com/photo-1571091718767-18b5b1457add?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'),
('Ichimliklar', 'Sovuq va issiq ichimliklar', 'https://images.unsplash.com/photo-1563227812-0ea4c22e6cc8?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'),
('Shirinliklar', 'An''anaviy va zamonaviy shirinliklar', 'https://images.unsplash.com/photo-1563729784474-d77dbb933a9e?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80');

INSERT INTO foods (name, description, price, category_id, image_url, rating, is_popular) VALUES
('Osh', 'An''anaviy o''zbek oshi, sabzi, go''sht va guruch bilan', 35000, 1, 'https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80', 4.9, 1),
('Lag''mon', 'Qo''lda yoyilgan xamir, go''sht va sabzavotlar bilan', 28000, 1, 'https://images.unsplash.com/photo-1551183053-bf91a1d81141?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80', 4.7, 1),
('Somsa', 'Yumshoq xamir, go''sht va piyoz bilan tayyorlangan', 8000, 1, 'https://images.unsplash.com/photo-1603133872878-684f208fb84b?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80', 4.8, 1),
('Manti', 'Bug''doy xamiri, go''sht va piyoz bilan', 25000, 1, 'https://images.unsplash.com/photo-1586190848861-99aa4a171e90?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80', 4.6, 1),
('Shashlik', 'Molly go''shtdan tayyorlangan, barbekyu sousi bilan', 20000, 1, 'https://images.unsplash.com/photo-1546833999-b9f581a1996d?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80', 4.9, 1),
('Chuchvara', 'Mayda chuchvara, qatiq va ziravorlar bilan', 22000, 1, 'https://images.unsplash.com/photo-1604329760661-e71dc83f8f26?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80', 4.5, 1),
('Burger', 'Molly kotlet, pomidor, salat va maxsus sous bilan', 25000, 2, 'https://images.unsplash.com/photo-1571091718767-18b5b1457add?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80', 4.4, 0),
('Pizza', 'Yupqa qobiq, pishloq, go''sht va sabzavotlar bilan', 60000, 2, 'https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80', 4.6, 0),
('Coca-Cola', '1.5L sovuq Coca-Cola', 10000, 3, 'https://images.unsplash.com/photo-1622483767028-3f66f32aef97?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80', 4.3, 0),
('Choy', 'Yashil yoki qora choy', 3000, 3, 'https://images.unsplash.com/photo-1563227812-0ea4c22e6cc8?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80', 4.7, 0),
('Halva', 'An''anaviy shirinlik, yog'' va un bilan', 15000, 4, 'https://images.unsplash.com/photo-1563729784474-d77dbb933a9e?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80', 4.8, 0),
('Napalyon', 'Qatlamli tort, krem bilan', 40000, 4, 'https://images.unsplash.com/photo-1578985545062-69928b1d9587?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80', 4.9, 0);

-- Create an admin user (password: admin123)
INSERT INTO users (first_name, last_name, email, phone, password_hash) VALUES
('Admin', 'User', 'admin@example.com', '+998901234567', 'admin123');